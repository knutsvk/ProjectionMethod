\documentclass[final,3p,twocolumn]{elsarticle}

\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{bm}

\biboptions{super, square, sort&compress}

\usepgfplotslibrary{groupplots, external, colormaps}
\tikzexternalize[prefix=Figures/]

\pgfplotscreateplotcyclelist{knuts}
{
    red,mark=x\\%
    blue,mark=o\\%
    teal,mark=triangle\\%
    purple,mark=*,mark size=.5pt\\%
    black,mark=diamond*,mark size=3pt\\%
}

\pgfplotsset
{   
    cycle list name=knuts, 
    colormap name={viridis},
    width=.9\columnwidth, 
    height=.9\columnwidth, 
    compat=1.12
}

\setcounter{secnumdepth}{3}

\journal{MPhil in Scientific Computing}

\begin{document}

\begin{frontmatter}

\title{Projection Method for Incompressible Flow}

\author{Knut Sverdrup}

\begin{abstract}
    In this report, we discuss computational methods for solving the
    incompressible Navier-Stokes equations in the two-dimensional test case of
    a lid-driven cavity. For Newtonian fluids, we demonstrate the
    implementation of a fractional-step projection method for solving the
    transient problem with high Reynolds numbers, and show that the system
    converges to the steady-state solution previously documented in the
    literature. Additionaly, we discuss the case of Reynolds number zero in
    Bingham plastic fluids, and how the steady-state solution can be computed
    through the SIMPLE algorithm when regularization is employed to deal with
    the singularity in apparent viscosity of such fluids. 
\end{abstract}

\end{frontmatter}

\section{Introduction}
\label{sec:introduction}

In physics, few equations span as wide a range of applications as the
Navier-Stokes equations of fluid dynamics. They govern the motion of viscous
fluids in a continuum framework, and as such have applications in {\em e.g.\ }
climate modelling \cite{marshall1997finite, giraldo2008study}, aerodynamics
\cite{rai1987navier, thomas1990navier, jameson1998optimum}, medicinal research
\cite{peskin1977numerical, mihaescu2008large} and petroleum engineering
\cite{deiber1979flow, vinay2006numerical, cardenas2007navier, boyer2010cahn},
to name a few. Named after Claude Navier and George Stokes for their major
contributions \cite{navier1822memoire, stokes1845theories} to its formulation
in the first half of the nineteenth century, the equations have constituted a
major field of research in their own right since their formulation, and
continue to do so today. Apart from their numerous applications, the equations
are fundamentally interesting from a mathematical point of view. In fact,
(dis-)proving the existence and uniqueness of their solutions is one of the
seven Millenium prize problems \cite{fefferman2006existence} for which a prize
of one million US dollars is associated. 

The generalized Navier-Stokes equations are based on the conservation of mass
through the continuity equation,

\begin{equation}
    \partial_t \rho + \nabla \cdot (\rho {\bm u}) = 0 \,,
    \label{eq:continuity}
\end{equation}
%
in addition to conservation of momentum as given by the Cauchy momentum equation

\begin{equation}
    \rho \left( \partial_t \bm{u} + \bm{u} \cdot \nabla \bm{u} \right) 
    = - \nabla p + \nabla \cdot \bm{\tau} + \bm{f} \,.
    \label{eq:cauchy}
\end{equation}
%
Here, we have introduced the primitive variables density $\rho$, velocity
$\bm{u}$ and pressure $p$, in addition to the deviatoric stress tensor
$\bm{\tau}$. The vector $\bm{f}$ accounts for external body sources such as
gravity acting on the fluid, and shall henceforth be disregarded. The
Navier-Stokes equations are an extension of Eqns.\ \eqref{eq:continuity} and
\eqref{eq:cauchy} derived under the assumptions that the stress tensor
$\bm{\tau}$ is a linear function of the strain tensor $\dot{\bm{\gamma}}=\nabla
\bm{u} + (\nabla \bm{u})^T$, that $\nabla \cdot \bm{\tau} = 0$ for fluids at
rest, and that the fluid is isotropoc. Given these assumptions, Eq.\
\eqref{eq:cauchy} can be rewritten

\begin{equation}
    \rho \left( \partial_t \bm{u} + \bm{u} \cdot \nabla \bm{u} \right) 
    = - \nabla p + \nabla \cdot \left( \mu \dot{\bm{\gamma}} \right) + \nabla
    \left( \lambda \nabla \cdot \bm{u} \right)
    \label{eq:compressible}
\end{equation}
%
where $\mu$ and $\lambda$ are the first and second coefficients of viscosity,
respectively. Fluids which obey the Navier-Stokes equations as given by Eqns.\
\eqref{eq:continuity} and \eqref{eq:compressible} are labelled Newtonian
fluids.  The second coefficient of viscosity, $\lambda$, is related to bulk
viscosity and disappears for incompressible flow, which we restrict ourselves
to in this project. Consequently, we shall simply refer to $\mu$ as the
viscosity of the fluid in the following. 

When the density $\rho$ is constant within each control volume of the fluid,
the flow is said to be isochoric or incompressible. A vast amount of cases in
continuum mechanics relate to incompressible flow, and several simplifications
arise in the description of the fluid. Firstly, Eq.\ \eqref{eq:continuity}
reduces to the incompressibility constraint

\begin{equation}
    \nabla \cdot \bm{u} = 0 \,.
    \label{eq:incompressibility}
\end{equation}
%
Secondly, the viscosity $\mu$ is constant for incompressible flow.
Consequently, Eq.\ \eqref{eq:compressible} simplifies to 

\begin{equation}
    \rho \left( \partial_t \bm{u} + \bm{u} \cdot \nabla \bm{u} \right) 
    = - \nabla p + \mu \nabla^2 \bm{u} \,,
    \label{eq:incompressible}
\end{equation}
%
where we have used the fact that $\nabla \cdot \dot{\bm{\gamma}} = \nabla^2
\bm{u}$ for incompressible flow. Eqns.\ \eqref{eq:incompressibility} and
\eqref{eq:incompressible} make up the incompressible Navier-Stokes equations
for incompressible flow. 

In order to nondimensionalize our system of equations, we move to dimensionless
variables such that $\bm{u} \rightarrow \frac{1}{a} \bm{u}$, $\partial_t \rightarrow
\frac{L}{a} \partial_t$ and $\nabla \rightarrow L \nabla$, where $L$ is
the length of the system under consideration and $a$ is the maximum absolute
value of the velocity. Applying these changes to Eq.\ \eqref{eq:incompressible}
and multiplying through by $L/(\rho a^2)$ gives the dimensionless equation 

\begin{equation}
    \partial_t \bm{u} + \bm{u} \cdot \nabla \bm{u} = - \frac{1}{\rho a^2}
    \nabla p + \frac{1}{\rm Re} \nabla^2 \bm{u} \,.
    \label{eq:dimensionless}
\end{equation}
%
Here, ${\rm Re} = \rho a L / \mu$ is the Reynolds number of the flow, which
equals the ratio of intertial forces to viscous ones. Note that the pressure
is still measured in physical units, as we wish to utilize different scalings
depending on the Reynolds number. Low Reynolds numbers correspond to laminar
flow, where the viscous forces are dominant. In this case, we let $p
\rightarrow \frac{\rm Re}{\rho a^2} p$, so that Eq.\ \eqref{eq:dimensionless}
becomes

\begin{equation}
    {\rm Re} \left( \partial_t \bm{u} + \bm{u} \cdot \nabla \bm{u} \right)  = -
    \nabla p + \nabla^2 \bm {u} \,.
    \label{eq:loRe}
\end{equation}
%
High Reynolds numbers, on the other hand, correspond to turbulent flow with the
most important contributions arising from the intertial forces. We then let $p
\rightarrow \frac{1}{\rho a^2} p$, yielding the alternative formulation 

\begin{equation}
    \partial_t \bm{u} + \bm{u} \cdot \nabla \bm{u} = - \nabla p
    + \frac{1}{\rm Re} \nabla^2 \bm {u} \,.
    \label{eq:hiRe}
\end{equation}
%
In our implementation of fractional step projection methods for incompresible
flow of Newtonian fluids, Eq.\ \eqref{eq:hiRe} is the formulation of interest.
When discussing creeping flow for Bingham plastic fluids, however, we return to
(a variant of) Eq.\ \eqref{eq:loRe}. 

Several models exist to describe different types of Non-Newtonian fluids, each
characterized by the way the stress $\tau = \sqrt{\frac{1}{2} \sum
\bm{\tau}_{i,j}^2}$ depends on the strain rate $\dot{\gamma} =
\sqrt{\frac{1}{2} \sum \dot{\bm{\gamma}}_{i,j}^2}$. The interesting variable is
the apparent viscosity $\eta = \tau/ \dot{\gamma}$. For Newtonian fluids, as we
have already seen, the relationship is linear, with slope $\eta = \mu$.
Non-Newtonian fluids include dilatants (shear-thickening, $\partial
\eta/\partial \dot{\gamma} > 0$) and pseudoplastics (shear-thinning, $\partial
\eta/\partial \dot{\gamma} < 0$), but in this project we restrict ourselves to
the relatively simple case of Bingham plastics. Figure \ref{fig:fluids}
illustrates the different types of fluids. 

\begin{figure}[htb]
    \centering
    \tikzsetnextfilename{Fluids}
    \begin{tikzpicture}
        \begin{axis}
            [
                height=0.8\columnwidth,
                axis x line=bottom, 
                xlabel=$\dot{\gamma}$, xmin=0, xmax=1,
                x label style={at={(1.05,0)}},
                axis y line=left,
                ylabel=$\tau$, ymin=0, ymax=2,
                y label style={at={(0,1.05)}},
                ylabel style={rotate=-90},
                ticks=none
            ]
            \addplot+[mark=none, color=black]{x};
            \node[anchor=south, rotate=23] at (axis cs:0.8,0.78) 
                {\footnotesize Newtonian};
            \addplot+[mark=none, color=black]{x+1};
            \node[anchor=south, rotate=23] at (axis cs:0.49,1.46) 
                {\footnotesize Bingham plastic};
            \addplot+[mark=none, color=black, samples=1000]{x+0.5*x^2};
            \node[anchor=south, rotate=40] at (axis cs:0.73,0.97) 
                {\footnotesize Dilatant};
            \addplot+[mark=none, color=black, samples=1000]{x-0.4*x^2};
            \node[anchor=south, rotate=8] at (axis cs:0.83,0.52) 
                {\footnotesize Pseudoplastic};
        \end{axis}
        \node[anchor=south] at (-0.3,2.1) {$B$};
        \draw (-0.1,2.335) -- (0,2.335);
    \end{tikzpicture}
    \caption{Classification of fluids based on apparent viscosity.}
    \label{fig:fluids}
\end{figure}

Bingham plastic fluids, named after Eugene Cook Bingham for his investigation
into them in 1916 \cite{bingham1916investigation}, have a threshold stress
$\tau_0$, below which they do not yield to applied forces. For the
nondimensionalized stress tensor, the yield stress corresponds to the
dimensionless Bingham number $B = \tau_0 L/(\mu a)$. In other words, the strain
rate is zero unless a stress higher than that characteristic stress is applied.
Physically, this means that they behave as solids for small stresses, something
which leads to interesting behaviour such as non-flat surfaces at rest. Regions
where the flow is such that $\tau < B$ are also known as unyielded
regions. The relationship between stress and shear rate for Bingham plastics is
therefore

\begin{equation}
    \dot{\gamma} = \begin{cases}
        0 \,,& \tau \leq B \\ 
        \tau - B \,,& \tau > B \end{cases} \,,
    \label{eq:bingham}
\end{equation}
%
from which it is evident that the apparent viscosity 

\begin{equation}
    \eta = \frac{B}{\dot{\gamma}} + 1 \,,
    \label{eq:binghamViscosity}
\end{equation}
%
and as such has a singularity for $\dot{\gamma}=0$. 

As a test framework for our numerical schemes, we apply them to the so-called
lid-driven cavity problem. The problem has served as a benchmark test for
viscous, incompressible fluid flow for decades, and reference solutions are
readily available, notably those produced by Ghia {\em et al.\ } in 1982
through the vorticity-strem function formulation and multigrid methods
\cite{ghia1982high}. This test case is fairly simple, and consists of a square
domain in 2D with sides of length $L$. At all sides, both solid-wall and
no-slip boundary conditions are applied, so that the component of $\bm{u} =
(u,v)^T$ normal to the wall is zero on the whole boundary, while the tangential
component equals the velocity of wall. In the lid-driven cavity test, all walls
are stationary except the top one (the ``lid''), which moves with constant
speed $a$. Figure \ref{fig:lidDrivenCavity} exhibits the test case
schematically. 

\begin{figure}[htb]
    \centering
    \tikzsetnextfilename{lidDrivenCavity}
    \begin{tikzpicture}
        \draw[thick,black, fill=blue!10!white] (0,0) rectangle (4,4);

        \draw[<-,thick] (3,2) arc (0:330:1);
        \draw[->,thick] (1,4.2) -- (3,4.2);
        \draw[->] (4,0) -- (5,0) node[right] {$x$};
        \draw[->] (0,4) -- (0,5) node[above] {$y$};

        \draw[] (4,0) -- (4,-0.1);
        \draw[] (0,4) -- (-0.1,4);
        \node[anchor=north] at (4,-0.1) {$L$};
        \node[anchor=east] at (-0.1,4) {$L$};

        \draw[] (0,0) -- (0,-0.1);
        \draw[] (0,0) -- (-0.1,0);
        \node[anchor=north] at (0,-0.1) {0};
        \node[anchor=east] at (-0.1,0) {0};

        \node[anchor=north] at (2,-0.1) {$u=0,\,v=0$};
        \node[anchor=south] at (2,4.2) {$u=a,\,v=0$};
        \node[anchor=east] at (-0.1,2.2) {$u=0,$};
        \node[anchor=east] at (-0.2,1.8) {$v=0$};
        \node[anchor=west] at (4.1,2.2) {$u=0,$};
        \node[anchor=west] at (4.12,1.8) {$v=0$};
    \end{tikzpicture}
    \caption{Lid-driven cavity test case.}
    \label{fig:lidDrivenCavity}
\end{figure}

In Section \ref{sec:numerical}, the numerical methods employed to solve the
incompressible Navier-Stokes equations for Newtonian fluids in the lid-driven
cavity are explained, in addition to the extensions needed for creeping flow of
Bingham plastics. Section \ref{sec:results} contains our results, which are the
basis of the discussion following in Section \ref{sec:discussion}. Section
\ref{sec:conclusion} concludes the report. 

\section{Numerical methods}
\label{sec:numerical}

\subsection{Newtonian fluid}

\subsubsection{Projection method}

In order to solve the transient problem given by Eqns.\ \eqref{eq:hiRe} and
\eqref{eq:incompressibility}, we implement a fractional-step projection method
following section 10.3 of Oleg Zikanov's {\em Essential Computational Fluid
Dynamics} \cite{zikanov2010essential}. The original projection method for
Navier-Stokes equations was invented by Chorin in 1968
\cite{chorin1968numerical}, and the essence is still the same in modern
variants. It is an operator splitting approach, in which, for each time step,
one first performs an intermediate time step while ignoring the pressure
forces, and then ignores the viscous forces in the second time step.
Temporal discretization of Eq. \eqref{eq:hiRe} is done explicitly for the
nonlinear term and implicitly for the linear ones, yielding the two equations 

\begin{align}
    \label{eq:firstStep}
    \frac{\tilde{\bm{u}}^{n+1} - \bm{u}^n}{\Delta t} + \bm{u}^n \cdot \nabla
    \bm{u}^n - \frac{1}{\rm Re} \nabla^2 \tilde{\bm{u}}^{n+1} &= 0 \,, \\
    \label{eq:secondStep}
    \frac{\bm{u}^{n+1} - \tilde{\bm{u}}^{n+1}}{\Delta t} + \nabla p^{n+1} &= 0
    \,,
\end{align}
%
which reduce to the discrete version of Eq. \eqref{eq:hiRe} when added
together. Here, we have introduced the notation $\bm{u}^n = \bm{u}(n \Delta
t)$, in addition to denoting by $\tilde{\bm{u}}^{n+1}$ the velocity at the
intermediate time step.  It is particularly important to utilize the implicit
temporal discretization for flows with low Reynolds numbers and for meshes that
are stretched near boundaries, since otherwise the numerical viscous stability
restriction becomes severe in these cases. 

Given a suitable spatial discretization scheme, Eq.\ \eqref{eq:firstStep} is
straightforward to solve since there is one known ($\bm{u}^n$) and one unknown
($\tilde{\bm{u}}^{n+1}$) quantity. The second step, however, has two unknowns.
This problem is solved by taking the divergence of Eq. \eqref{eq:secondStep}
and enforcing $\nabla \cdot \bm{u}^{n+1} = 0$, leading to a Poisson equation
for the pressure:

\begin{equation} 
    \nabla^2 p^{n+1} = \frac{1}{\Delta t} \nabla \cdot \tilde{\bm{u}}^{n+1} \,.
    \label{eq:poissonPressure}
\end{equation}
%
By doing so, the intermediate, unphysical velocity, which was computed without
enforcing incompressibility, is projected onto the space of vector fields
satistfying Eq.\ \eqref{eq:incompressibility}. Note that the boundary
conditions are also affected by taking the divergence, as by doing so the
Dirichlet conditions are transformed to Neumann type. 

The velocity at time $t^{n+1}$ can finally be updated by rearranging Eq.\
\eqref{eq:secondStep} to read 

\begin{equation}
    \bm{u}^{n+1} = \tilde{\bm{u}}^{n+1} + \Delta t \nabla p^{n+1} \,. 
    \label{eq:velocityUpdate}
\end{equation}

\subsubsection{Finite volumes}

Spatial discretization is done through finite volumes with a staggered grid,
{\em i.e.\ } a grid where the three primitive variables are evaluated at
different points.  The need for a staggered grid is due to the relationship
between pressure and velocity. On a regular grid, a checkerboard pattern occurs
in their dependencies upon each other, leading to decoupling and thus spurious
pressure instabilities.  Our domain is split into $N$ equal subdomains for
pressure in each spatial direction, leading to a total of $N^2$ subdomains of
area $\Delta x^2$, where $\Delta x = 1/N$ (we employ the same grid spacing in
both directions). In the centre of each of these squares, the pressure is
evaluated, while the $x$- and $y$-components of velocity are evaluated on their
vertical and horizontal borders, respectively.  Consequently, the control
volumes for the first and second components of the momentum balance equations
in the finite volume method are shifted by $\frac{1}{2} \Delta x$ compared to
the control volumes used for the Poisson equation for pressure. The staggered
grid with shifted control volumes is illustrated in Figure
\ref{fig:staggeredGrid}.

\begin{figure}[htb]
    \centering
    \tikzsetnextfilename{staggeredGrid}
    \begin{tikzpicture}
        \draw[thick,black] (0,0) rectangle (5,5);
        \draw[->] (-0.1,0) -- (5.5,0) node[right] {$x$};
        \draw[->] (0,-0.1) -- (0,5.5) node[above] {$y$};
        \node at (0.5,-0.5) {\footnotesize $i=1$};
        \node at (1.5,-0.5) {\footnotesize $i=2$};
        \node at (3,-0.5) {\footnotesize $\cdots$};
        \node at (4.5,-0.5) {\footnotesize $i=N$};
        \node at (-0.5,0.5) {\footnotesize $j=1$};
        \node at (-0.5,1.5) {\footnotesize $j=2$};
        \node at (-0.5,3) {\footnotesize $\vdots$};
        \node at (-0.5,4.5) {\footnotesize $j=N$};

        \draw[ultra thick,blue] (1,1) rectangle (2,2);
        \draw[ultra thick,dotted,green!50!black] (2.5,1) rectangle (3.5,2);
        \draw[ultra thick,dashed,red] (1,2.5) rectangle (2,3.5);

        \foreach \i in {1,...,4} {
            \draw (\i,0) -- (\i,5);
            \draw (0,\i) -- (5,\i);
        }

        \foreach \i in {0,...,4} {
            \foreach \j in {0,...,4} 
            {
                \node at (\i+0.5,\j+0.5) {\color{blue}{$\circ$}};
            }
        }

        \foreach \i in {0,...,3} {
            \foreach \j in {0,...,4} 
            {
                \node at (\i+1,\j+0.5) {\color{green!50!black}{$\times$}};
                \node at (\j+0.5,\i+1) {\color{red}{$*$}};
            }
        }


    \end{tikzpicture}
    \caption
    {
        Spatial discretization of the square domain with a staggered grid. At the different
        points, the primitive variables are evaluated: \textcolor{blue}{$\circ$}
        $p$, \textcolor{green!50!black}{$\times$} $u$, \textcolor{red}{$*$}
        $v$. Examples of control volumes for pressure ($i=2$, $j=2$),
        $x$-velocity ($i=3.5$, $j=2$) and $y$-velocity ($i=2$,$j=2.5$) are also
        shown with corresponding colors. In this example, $N=5$. 
    }
    \label{fig:staggeredGrid}
\end{figure}

We denote by $\Omega_{i,j}$ the control volume centred at
$(x_i,y_j)=\left(i\Delta x - 1/2, j\Delta x - 1/2\right)$. In
integral form over a control volume centred at a $u$-point, the first component
of Eq.\ \eqref{eq:firstStep} reads 

\begin{multline}
    \int_{\Omega_{i+\frac{1}{2},j}} \tilde{u}^{n+1} {\rm d}V - \frac{\Delta t}{\rm Re}
    \int_{\Omega_{i+\frac{1}{2},j}} \nabla^2 \tilde{u}^{n+1} {\rm d}V \\
    = \int_{\Omega_{i+\frac{1}{2},j}} u^n {\rm d}V + \Delta t
    \int_{\Omega_{i+\frac{1}{2},j}} (u^n \partial_x u^n + v^n \partial_y u^n)
    {\rm d}V \,.
    \label{eq:velocityIntegralForm}
\end{multline}
%
We approximate the first term on each side of the equation by the
two-dimensional midpoint rule, {\em i.e.\ } 

\begin{equation}
    \int_{\Omega_{i+\frac{1}{2},j}} \tilde{u}^{n+1} {\rm d}V \approx
    \tilde{u}_{i+\frac{1}{2},j}^{n+1} (\Delta x)^2 \,, 
    \label{eq:firstApprox}
\end{equation}
%
and similar for $u^n$. Derivatives are approximated by central differences, and
when evaluation of a variable is necessary at a point where it is not defined,
the mean value of the nearest neighbours to the point is taken instead. Thus,
the integral in the term with the Laplacian becomes 

\begin{multline}
    \int_{\Omega_{i+\frac{1}{2},j}} \nabla^2 \tilde{u}^{n+1} {\rm d}V =
    \int_{\partial \Omega_{i+\frac{1}{2},j}} \partial_n \tilde{u}^{n+1} 
    {\rm d}S \\
    \approx \tilde{u}_{i+\frac{3}{2},j}^{n+1} +
    \tilde{u}_{i+\frac{3}{2},j}^{n+1} + \tilde{u}_{i+\frac{3}{2},j}^{n+1} +
    \tilde{u}_{i+\frac{3}{2},j}^{n+1} - 4\tilde{u}_{i+\frac{3}{2},j}^{n+1} \,, 
\end{multline}
%
while the integrals in the nonlinear term are approximated as 

\begin{align}
    \int_{\Omega_{i+\frac{1}{2},j}} u^n \partial_x u^n {\rm d}V \approx
    u_{i+\frac{1}{2},j}^n \frac{1}{2} (u_{i+\frac{3}{2},j}^n -
    u_{i-\frac{1}{2},j}^n) \Delta x \,, \\
    \nonumber 
    \int_{\Omega_{i+\frac{1}{2},j}} v^n \partial_y u^n {\rm d}V \approx
    \frac{1}{2}(u_{i+\frac{1}{2},j+1}^n-u_{i+\frac{1}{2},j-1}^n) \Delta x \\ 
    \label{eq:lastApprox}
    \times \frac{1}{4} (v_{i+1,j+\frac{1}{2}}^n + v_{i+1,j-\frac{1}{2}}^n +
    v_{i+1,j+\frac{1}{2}}^n + v_{i+1,j-\frac{1}{2}}^n) \,.
\end{align}
%
By substituting the approximations in Eqns.\ \eqref{eq:firstApprox} -
\eqref{eq:lastApprox} in Eq.\ \eqref{eq:velocityIntegralForm}, we arrive at a
matrix equation of the form 

\begin{equation}
    A_{uv} \tilde{\bf u} = {\bf f}_u + {\bf b}_u \,,
    \label{eq:xVelocityMatrix}
\end{equation}
%
where $A_{uv}$ is an $N(N-1) \times N(N-1)$ matrix, $\tilde{\bf u}$ is a vector
containing the discrete values of $\tilde{u}^{n+1}$ at each point and ${\bf
f}_u$ is a load vector depending only on values of ${\bf u}$ and ${\bf v}$ at
the previous time step. \footnote{Note that bold symbols in italics refer to
physical variables such as $\bm{u}=(u,v)^T$, while roman bold symbols are
vectors of discrete values, {\em e.g.\ } ${\bf u} = \{u_{i+\frac{1}{2},j}\}$
for $i \in \{ 1,2,\dots,N-1$ \}, $j \in \{ 1,2,\dots,N \}$.} The vector ${\bf b}_u$ takes into
consideration the boundary conditions, and will be treated shortly. The matrix
is a sparse block tridiagonal matrix of the form

\begin{equation*}
    A_{uv} = 
    \begin{pmatrix}
        I - \alpha B & -\alpha I \\
        -\alpha I & I - \alpha B & -\alpha I \\
        & & \ddots \\
        & & -\alpha I & I - \alpha B
    \end{pmatrix} \,,
\end{equation*}
%
where $\alpha = \frac{\Delta t}{{\rm Re}(\Delta x)^2}$, $I$ is the identity
matrix and

\begin{equation*}
    B = 
    \begin{pmatrix}
        -4 & 1 \\
        1 & -4 & 1 \\
        & & \ddots \\ 
        & & 1 & -4
    \end{pmatrix} \,.
\end{equation*}

By the exact same procedure for the second component of Eq.\
\eqref{eq:firstStep}, using control volumes $\Omega_{i,j+\frac{1}{2}}$, one
arrives at a similar equation for the intermediate $y$-velocities: 

\begin{equation}
    A_{uv} \tilde{\bf v} = {\bf f}_v + {\bf b}_v \,,
    \label{eq:yVelocityMatrix}
\end{equation}

By comparison, the spatial discretization of Eq.\ \eqref{eq:poissonPressure} is
straightforward. In discrete form over a control volume, it reads 

\begin{equation}
    \int_{\Omega_{i,j}} \nabla^2 p^{n+1} {\rm d}V = \frac{1}{\Delta t}
    \int_{\Omega_{i,j}} \nabla \cdot \tilde{\bm{u}}^{n+1} {\rm d}V \,.
\end{equation}
%
We discretize the pressure term as 

\begin{align}
    \nonumber
    \int_{\Omega_{i,j}} & \nabla^2 p^{n+1} {\rm d}V = 
    \int_{\partial \Omega_{i,j}} \nabla p^{n+1} \cdot {\rm d}\bm{S} \\
    \approx& p_{i+1,j}^{n+1} + p_{i,j-1}^{n+1} + p_{i-1,j}^{n+1} +
    p_{i,j+1}^{n+1} -4 p_{i,j}^{n+1} \,,
\end{align}
%
while the term containing the intermediate velocity becomes 

\begin{align}
    \nonumber
    \int_{\Omega_{i,j}} & \nabla \cdot \tilde{\bm{u}}^{n+1} {\rm d}V = 
    \int_{\partial \Omega_{i,j}} \tilde{\bm{u}}^{n+1} \cdot {\rm d}\bm{S} \\
    \approx& (\tilde{u}_{i+\frac{1}{2},j}^{n+1} -
    \tilde{u}_{i-\frac{1}{2},j}^{n+1} + \tilde{v}_{i,j+\frac{1}{2}}^{n+1} -
    \tilde{v}_{i,j-\frac{1}{2}}^{n+1}) \Delta x \,.
\end{align}
%
We thus end up with a system of linear equations: 

\begin{equation}
    A_p {\bf p} = {\bf f}_p + {\bf b}_p \,.
    \label{eq:pressureMatrix}
\end{equation}
%
In this case, there are $N^2$ variables and unknowns, and the matrix is given
by 

\begin{equation*}
    A_p = 
    \begin{pmatrix}
        B & I \\
        I & B & I \\
        & & \ddots \\ 
        & & I & B
    \end{pmatrix} \,.
\end{equation*}

\subsubsection{Boundary conditions}

Special consideration must be taken near the boundaries of the domain. The
update formula for an $x$-momentum control volume requires information taken
from the four nearest $x$-momentum control volumes (north, east, south and
west) in addition to the four nearest $y$-momentum control volumes (northeast,
southeast, southwest and northwest). Upon investigation of Figure
\ref{fig:staggeredGrid}, it is evident that we then need ghost cells for
$\tilde{u}$ at $i=1/2$, $i=N+1/2$, $j=0$ and $j=N+1$. The first two are given
immediately by the Dirichlet conditions (no-slip, solid wall), while the latter
are computed using interpolation. 


\begin{align}
    \nonumber 
    \tilde{u}_{\frac{1}{2},j}^n &= 0 \,, &\quad \tilde{u}_{N + \frac{1}{2},j}^n
    &= 0 \,, \\
    \label{eq:xVelocityBCs}
    \tilde{u}_{i+\frac{1}{2},0}^n &= - \tilde{u}_{i+\frac{1}{2},1}^n \,, &\quad
    \tilde{u}_{i+\frac{1}{2},N+1}^n &= 2a - \tilde{u}_{i+\frac{1}{2},N}^n \,.
\end{align}
%
Utilizing the same technique for $\tilde{v}$, we have 

\begin{align}
    \nonumber
    \tilde{v}_{i,\frac{1}{2}}^n &= 0 \,, &\quad 
    \tilde{v}_{i, N + \frac{1}{2}}^n &= 0 \,, \\
    \label{eq:yVelocityBCs}
    \tilde{v}_{0, j+\frac{1}{2}}^n &= - \tilde{v}_{1, j+\frac{1}{2}}^n \,,
    &\quad \tilde{v}_{N+1, j+\frac{1}{2}}^n &= - \tilde{v}_{N, j+\frac{1}{2}}^n
    \,.
\end{align}

The boundary condiions for $p$ are less obvious, and have been subject to
debate in the literature \cite{liu1995projection}. As there are no physical
boundary conditions on $p$, one could take the inner product of Eq.\
\eqref{eq:hiRe} with either the unit normal or unit tangent at the boundary,
and retrieve equally feasile boundary conditions. In general, the former is
preferred by most people, since the condition relates naturally to the
projection operator. Requiring that the space of divergence-free vector fields
is orthogonal to the space of irrotational vector fields results in the boundary
condition $\bm{u}^{n+1} \cdot \bm{n} = 0$. Taking the inner product of Eq.\
\eqref{eq:secondStep} with $\bm{n}$ thus gives $\partial_n p = 0$ on the
domain border. Our boundary conditions for the pressure are then

\begin{align}
    \nonumber
    p_{0,j}^{n+1} &= p_{1,j}^{n+1} \,, &\quad p_{i,0}^{n+1} &= p_{i,1}^{n+1}
    \,, \quad \\
    \label{eq:pressureBCs}
    p_{N+1,j}^{n+1} &= p_{N,j}^{n+1} \,, &\quad p_{i,N+1}^{n+1} &=
    p_{i,N}^{n+1} \,.
\end{align}

\subsubsection{Eigen for systems of equations}

Each of the linear systems in Eqns.\ \eqref{eq:xVelocityMatrix},
\eqref{eq:yVelocityMatrix} and \eqref{eq:pressureMatrix} are solved using a C++
template library for linear algebra called Eigen \cite{eigenweb}. Since the
matrices are sparse, we exploit the special sparse datastructures available in
Eigen, and solve the systems using a simplicial Cholesky factorization
($LDL^T$). The choice of factorization is for efficiency, and can be used since
the sparse matrics are self-adjoint and positive definite. 

\subsubsection{Stability and convergence to steady-state}

An important question in any time-marching scheme for PDEs is the restriction
on the time step $\Delta t$ necessary to achieve stability. For a nonlinear
scheme such as the one employed, analytical stability restrictions are not
available to the best knowledge of the author, but it is still possible to
gather some insights from investigating the scheme. The restrictions on $\Delta
t$ are dependent on $\alpha = \frac{\Delta t}{{\rm Re} (\Delta x)^2}$ from the 
diffusive term and $\beta = \frac{a \Delta t}{\Delta x}$ from the convective
one. A possibility is therefore to choose $\Delta t$ as a constant times the
minimum of these two restrictors, {\em i.e.\ } 

\begin{equation}
    \Delta t = C \min \left\{ \frac{\Delta x}{a}, {\rm Re} (\Delta x)^2
    \right\} \,.
    \label{eq:timeStep}
\end{equation}
 
Another approach is to perform stability analysis on a linearized version of
the scheme, and transfer the knowledge to the application of the nonlinear
method. It has been shown that the general form of the dependency of $\Delta
t$ on $\Delta x$, $a$ and ${\rm Re}$ is predicted only somewhat correctly from
this type of procedure \cite{kress2006time}. 

Since no thorough analysis is possible, we have chosen to do a numerical
trial-and-error experiment to find the maximum time step $\Delta t_m$ which
produces stable results for a series of different Reynolds numbers and grid
sizes. We can then choose the time step in a manner which ensures that $\Delta
t < \Delta t_m$. 

If the system converges to steady-state behaviour, the change in the primitive
variables will approach zero. We therefore set a tolerance $\epsilon$ and
advance the system in time until the relative change in the uniform norm of
the vector of discrete velocity values becomes smaller than that tolerance.  In
other words, we require $\frac{||{\bf u}^{n+1} - {\bf u}^{n}||_{\infty}}{||{\bf
u}^{n+1}||_{\infty}} < \epsilon$ for convergence. 

\subsubsection{Vorticity and stream function formulation}

Our reference solutions are those of Ghia {\em et al.\ } \cite{ghia1982high},
but their calculations are based on a vorticity and stream function formulation
of the 2D Navier-Stokes equations. In order to compare our results more
efficiently, we therefore compute these quantities at the end of the
simulation. The scalar stream function $\psi$ is defined for incompressible
flow in 2D through the velocity components such that 

\begin{equation}
    u = \partial_y \psi \,, \quad v = - \partial_x \psi \,.
    \label{eq:streamFunction}
\end{equation}
%
The difference between the stream function at two points equals the
volumetric flux through a line contacting these points. Contour lines of the
stream function are known as stream lines. Stream lines are parallel to the
velocity field at all points in the domain, and trace the movement of particles
in the fluid. Vorticity, on the other hand, describes the local spinning motion
of the fluid at a point. Although a vector quantity in general (the curl of the velocity
field), in 2D there is only one non-zero component. We thus define the
vorticity as 

\begin{equation}
    \omega = |\nabla \times \bm{u}| = \partial_x v - \partial_y u \,,
    \label{eq:vorticity}
\end{equation}
%
which means that computation of the vorticity at grid points
$(x_{i+\frac{1}{2}}, y_{j+\frac{1}{2}})$ in our mesh is straightforward
given the velocity components.  Insertion of Eq.\ \eqref{eq:streamFunction}
into Eq.\ \eqref{eq:vorticity} gives a simple Poisson equation relating $\psi$
to $\omega$: 

\begin{equation}
    \omega = - \nabla^2 \psi
    \label{eq:poissonVorticity}
\end{equation}
%
Conversion from primitive variables to stream function and vorticity can thus
be achieved by first calculating the vorticity at $(N-1)^2$ points, and
subsequently solving Eq.\ \eqref{eq:poissonVorticity} with zero boundary
conditions. 

\subsection{Bingham plastic fluid}
\label{subsec:bingham}

Extension of the 2D Navier-Stokes solver to the particular case of
Non-Newtonian fluids known as Bingham plastics introduces two difficulties.
Firstly, the discretization of the viscous term is cumbersome. As introduced in
Section \ref{sec:introduction}, the viscous term $\nabla^2 \bm{u}$ is replaced
by $\nabla \cdot \bm{\tau}$ for these fluids, where 

\begin{equation} 
    \bm{\tau} = \eta(\dot{\gamma}) \bm{\dot{\gamma}} = \left(
    \frac{B}{\dot{\gamma}} + 1 \right) \dot{\bm{\gamma}} \,.
    \label{eq:binghamStress}
\end{equation}
%
It is not possible to discretize this term implicitly in time while retaining
the linearity of the system for $\tilde{\bm{u}}^{n+1}$. Secondly, the
singularity of the apparent viscosity for $\dot{\gamma}=0$ cannot be handled
directly computationally. 

\subsubsection{Creeping flow}

An idea for circumventing the first of these problems is to discretize the
fluid strain rate tensor implicitly while accepting an explicit temporal
discretization for the strain rate magnitude in the apparent viscosity, in
other words pursuing a discretization such as $\bm{\tau}^{n+\frac{1}{2}} =
\eta(\dot{\gamma}^{n}) \dot{\bm{\gamma}}^{n+1}$. This would result in a
solvable system of equations. As we restrict ourselves to the case of creeping
flows (${\rm Re}=0$), however, this problem vanishes automatically. Equation
\eqref{eq:loRe} applied to the case of Bingham plastic fluids reads 

\begin{equation}
    {\rm Re} \left( \partial_t \bm{u} + \bm{u} \cdot \nabla \bm{u} \right)  = -
    \nabla p + \nabla \cdot \eta ( \dot{\gamma} ) \dot{\bm{\gamma}} \,,
\end{equation}
%
but when ${\rm Re} \rightarrow 0$, the left side of the equation vanishes and we are left
with the problem of solving 

\begin{equation}
    \nabla p = \nabla \cdot \eta ( \dot{\gamma} ) \dot{\bm{\gamma}} 
    \label{eq:binghamPDE}
\end{equation}
%
under the incompressibility criterion of Eq.\ \eqref{eq:incompressibility}. We
therefore only make a note that computational solutions exist for Bingham
plastics in the unsteady case (see {\em e.g.\ } Vola {\em et al.\ }
\cite{vola2003laminar}), and concentrate our efforts on the steady-state case
when Eq.\ \eqref{eq:binghamPDE} is satisfied. 

\subsubsection{Regularization}

\begin{itemize}
    \item Treatment of singularity in effective viscosity: regularization
        \cite{papanastasiou1987flows}. Physical interpretation: replace
        ``solid'' in unyielded zone by high-viscostiy fluid. 
\end{itemize}

\begin{equation}
    \eta = \frac{B}{\dot{\gamma}} \left(1-e^{-m\dot{\gamma}} \right) + 1
\end{equation}

\begin{figure}[htb]
    \centering
    \tikzsetnextfilename{Regularization}
    \begin{tikzpicture}
        \begin{axis}
            [
                width=0.8\columnwidth,
                height=0.6\columnwidth,
                axis x line=bottom, 
                xlabel=$\dot{\gamma}$, xmin=0, xmax=0.8,
                domain=0:0.8,
                x label style={at={(1.05,0)}},
                axis y line=left,
                ylabel=$\tau$, ymin=0, ymax=2,
                y label style={at={(0,1.05)}},
                ylabel style={rotate=-90},
                ticks=none,
                samples=500
            ]
            \addplot[mark=none,color=blue!30!white]{x+1-exp(-4*x)};
            \addplot[mark=none,color=blue!40!white]{x+1-exp(-8*x)};
            \addplot[mark=none,color=blue!50!white]{x+1-exp(-16*x)};
            \addplot[mark=none,color=blue!60!white]{x+1-exp(-32*x)};
            \addplot[mark=none,color=blue!70!white]{x+1-exp(-64*x)};
            \addplot[mark=none,color=blue!80!white]{x+1-exp(-128*x)};
            \addplot[mark=none,color=blue!90!white]{x+1-exp(-256*x)};
            \addplot[mark=none,color=black]{x+1};
        \end{axis}
        \node[anchor=south] at (-0.3,1.3) {$B$};
        \draw (-0.07,1.55) -- (0,1.55) {};
    \end{tikzpicture}
    \caption{Regularization technique to mimic the behaviour of Bingham
        ``plastic'' 
    plastics.}
    \label{fig:regularization}
\end{figure}

\subsubsection{Spatial discretization}

\begin{itemize}
    \item Finite volume method w/o need for staggered grid, discretization of
        viscous term
\end{itemize}

\subsubsection{SIMPLE and friends}

\begin{itemize}
    \item Solution of steady-state system: SIMPLE and its extensions
\end{itemize}

\section{Results}
\label{sec:results}

\subsection{Analysis of time step size}
\label{subsec:timeStep}

Text about Figure \ref{fig:dt}. We use $\Delta t = 500 \Delta x / {\rm Re}$
based on the results. This produces stable simulations up to $N=129$ and ${\rm
Re}=1000$. For Re$>1000$, we use $\Delta t = 100 \Delta x / {\rm Re}$.

\begin{figure}[htb]
    \centering
    \tikzsetnextfilename{dt}
    \begin{tikzpicture}
        \begin{axis}
            [
                height=0.8\columnwidth,
                xlabel=Re, xmin=100, xmax=1100, 
                ylabel=$\Delta t_m$, 
                ylabel style={rotate=-90},
                yticklabel style=
                {
                    /pgf/number format/fixed,
                    /pgf/number format/precision=2
                }
            ]
            \addplot+[only marks] table[x={Re}, y={N17}]{../Results/dt.out};
            \addlegendentry{$N=17$};
            \addplot+[only marks] table[x={Re}, y={N33}]{../Results/dt.out};
            \addlegendentry{$N=33$};
            \addplot+[only marks] table[x={Re}, y={N65}]{../Results/dt.out};
            \addlegendentry{$N=65$};
            \addplot[draw=red,dashed,domain=150:1050,samples=100]{500/(17*x)};
            \addplot[draw=blue,dashed,domain=150:1050,samples=100]{500/(33*x)};
            \addplot[draw=teal,dashed,domain=150:1050,samples=100]{500/(65*x)};
        \end{axis}
    \end{tikzpicture}
    \caption{Time step analysi yo!}
    \label{fig:dt}
\end{figure}

\subsection{Transient behaviour}
\label{subsec:transient}

\begin{itemize}
    \item Impulsively started
    \item What happens as a function of time? 
    \item Results for different Re? 
\end{itemize}

\subsection{Steady-state solution}
\label{subsec:steady}

\begin{figure*}[t]
    \centering
    \tikzsetnextfilename{uSlice}
    \begin{tikzpicture}
        \begin{groupplot}
            [
                height=0.8\columnwidth,
                width=\columnwidth,
                group style=
                {
                    group size=2 by 2, 
                    xlabels at=edge bottom, 
                    xticklabels at=edge bottom, 
                    ylabels at=edge left, 
                    vertical sep=25pt, 
                    horizontal sep=25pt
                },
                xlabel=$y$, xmin=0, xmax=1, 
                ylabel=$u$, 
                ylabel style={rotate=-90}
            ]
            \nextgroupplot[title={Re=100}]
            \foreach \N in {17,33,65,129}
            {
                \addplot+[only marks] table{../Results/uGC_N\N_Re100.out}; 
            }
            \addplot+[only marks] table[x={y}, y={Re100}]{../Results/uGC.ref};

            \nextgroupplot[title={Re=400}]
            \foreach \N in {17,33,65,129}
            {
                \addplot+[only marks] table{../Results/uGC_N\N_Re400.out}; 
            }
            \addplot+[only marks] table[x={y}, y={Re400}]{../Results/uGC.ref};

            \nextgroupplot[title={Re=1000}]
            \foreach \N in {17,33,65,129}
            {
                \addplot+[only marks] table{../Results/uGC_N\N_Re1000.out}; 
            }
            \addplot+[only marks] table[x={y}, y={Re1000}]{../Results/uGC.ref};

            \nextgroupplot[title={Re=3200}]
            \foreach \N in {17,33,65,129}
            {
                \addplot+[only marks] table{../Results/uGC_N\N_Re3200.out}; 
            }
            \addplot+[only marks, unbounded coords=jump, 
            y filter/.expression={y<-0.5 ? nan : y}] 
            table[x={y}, y={Re3200}]{../Results/uGC.ref};
        \end{groupplot}
    \end{tikzpicture}
    \caption{First component of velocity through $x=0.5$.}
    \label{fig:uGC}
\end{figure*}
%
%\begin{figure*}[t]
%    \centering
%    \tikzsetnextfilename{vSlice}
%    \begin{tikzpicture}
%        \begin{groupplot}
%            [
%                height=0.8\columnwidth,
%                width=\columnwidth,
%                group style=
%                {
%                    group size=2 by 2, 
%                    xlabels at=edge bottom, 
%                    xticklabels at=edge bottom, 
%                    ylabels at=edge left, 
%                    vertical sep=25pt, 
%                    horizontal sep=25pt
%                },
%                xlabel=$x$, xmin=0, xmax=1, 
%                ylabel=$v$, 
%                ylabel style={rotate=-90}
%            ]
%            \nextgroupplot[title={Re=100}]
%            \foreach \N in {17,33,65,129}
%            {
%                \addplot+[only marks] table{../Results/vGC_N\N_Re100.out}; 
%            }
%            \addplot+[only marks] table[x={x}, y={Re100}]{../Results/vGC.ref};
%
%            \nextgroupplot[title={Re=400}]
%            \foreach \N in {17,33,65,129}
%            {
%                \addplot+[only marks] table{../Results/vGC_N\N_Re400.out}; 
%            }
%            \addplot+[only marks] table[x={x}, y={Re400}]{../Results/vGC.ref};
%
%            \nextgroupplot[title={Re=1000}]
%            \foreach \N in {17,33,65,129}
%            {
%                \addplot+[only marks] table{../Results/vGC_N\N_Re1000.out}; 
%            }
%            \addplot+[only marks] table[x={x}, y={Re1000}]{../Results/vGC.ref};
%
%            \nextgroupplot[title={Re=3200}]
%            \foreach \N in {17,33,65,129}
%            {
%                \addplot+[only marks] table{../Results/vGC_N\N_Re3200.out}; 
%            }
%            \addplot+[only marks] table[x={x}, y={Re3200}]{../Results/vGC.ref};
%        \end{groupplot}
%    \end{tikzpicture}
%    \caption{Second component of velocity through $y=0.5$.}
%    \label{fig:vGC}
%\end{figure*}
%
%\begin{figure*}[t]
%    \centering
%    \foreach \Re in {100,400,1000,3200}
%    {
%        \pgfplotstableread{../Results/psi_N129_Re\Re.out}{\psi}
%        \tikzsetnextfilename{Stream_Re\Re}
%        \begin{tikzpicture}
%            \begin{axis}
%            [
%                title={${\rm Re}=\Re$},
%                xlabel={$x$}, ylabel={$y$},
%                xmin=0, xmax=1, ymin=0, ymax=1,
%                view={0}{90}
%            ]
%                \addplot3[surf,shader=interp] table[]{\psi}; 
%                \addplot3
%                [
%                    mesh/rows=128, mesh/cols=128, 
%                    contour gnuplot=
%                    {
%                        labels=false, 
%                        draw color=black, 
%                        levels=
%                        {
%                            -1e-10, -1e-7, -1e-5, -1e-4, -.01, -.03, -.05, -.07,
%                            -.09, -.1, -.11, -.115, -.1175, 1e-8, 1e-7, 1e-6, 1e-5,
%                            5e-5, 1e-4, 2.5e-4, 5e-4, 1e-3, 1.5e-3, 3e-3 
%                        }
%                    }
%                ]
%                table{\psi}; 
%                \addplot[white, quiver={u=\thisrow{u},v=\thisrow{v}, scale arrows=0.5}, -stealth]
%                table[each nth point=510]{../Results/vec_N129_Re\Re.out};
%                \addplot[white, quiver={u=\thisrow{u},v=\thisrow{v}, scale arrows=0.5}, -stealth]
%                table[each nth point=514]{../Results/vec_N129_Re\Re.out};
%            \end{axis}
%        \end{tikzpicture}
%    }
%    \caption{Stream function for different Reynold's numbers}
%    \label{fig:stream}
%\end{figure*}
%
%\begin{figure*}[t]
%    \centering
%    \foreach \Re in {100,400,1000,3200}
%    {
%        \pgfplotstableread{../Results/omega_N129_Re\Re.out}{\omega}
%        \tikzsetnextfilename{Vorticity_Re\Re}
%        \begin{tikzpicture}
%            \begin{axis}
%            [
%                title={${\rm Re}=\Re$},
%                xlabel={$x$}, ylabel={$y$},
%                xmin=0, xmax=1, ymin=0, ymax=1,
%                point meta min=-6, point meta max=6,
%                view={0}{90}
%            ]
%                \addplot3[surf,shader=interp] table[]{\omega}; 
%                \addplot3
%                [
%                    mesh/rows=128, mesh/cols=128, 
%                    contour gnuplot=
%                    {
%                        labels=false, 
%                        draw color=black, 
%                        levels={-3,-2,-1,-0.5,0,0.5,1,2,3,4,5}
%                    }
%                ]
%                table[]{\omega}; 
%            \end{axis}
%        \end{tikzpicture}
%    }
%    \caption{Vorticity for different Reynold's numbers}
%    \label{fig:vorticity}
%\end{figure*}

\subsection{Computational efficiency}
\label{subsec:efficiency}

\begin{itemize}
    \item Computational complexity of the linear systems
    \item Runtime (and no of time steps) as a function of Re and $N$
\end{itemize}

\section{Discussion}
\label{sec:discussion}

\begin{itemize}
    \item Everything works, results exactly as in literature
    \item Transient method is slow for high Re, SIMPLE could be better
    \item Other improvements include Hockney algorithm and multigrid methods
    \item Discuss stability and computational efficiency of
\end{itemize}

\section{Conclusions}
\label{sec:conclusion}


\section*{References}
\bibliographystyle{elsarticle-num}
\bibliography{references.bib}

\end{document}
